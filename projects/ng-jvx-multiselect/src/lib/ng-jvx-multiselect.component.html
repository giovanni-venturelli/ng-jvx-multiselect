<div class="ng-jvx-multiselect" #jvxMultiselect>
  <div [ngClass]="{'ng-jvx-multiselect-value-container': true, 'is-open': isOpen}" [matMenuTriggerFor]="menuRef" #valueContainer (onMenuOpen)="onMenuOpen()" (onMenuClose)="onMenuClose()">
    <div class="ng-jvx-multiselect-value multi-value-container" *ngIf="multi">
      multi
    </div>
    <div class="ng-jvx-multiselect-value single-value-container" *ngIf="!multi">
      <span *ngFor="let val of value">{{val[itemText]}}</span>
    </div>
    <div class="ng-jvx-multiselect-arrow">
      <mat-icon>expand_more</mat-icon>
    </div>
  </div>
  <mat-menu #menuRef="matMenu" class="jvx-multiselect-panel" [formGroup]="form" >

    <mat-selection-list #selection [multiple]="multi" [(ngModel)]="selectionValue"
                        [ngStyle]="{'width.px': jvxMultiselect.offsetWidth, 'min-width.px': 112}"
                        (click)="onCLickOnMenu($event)"
                        (selectionChange)="onChange($event)"
                        formControlName="selectionValue">
      <ng-content></ng-content>
      <ng-jvx-option *ngFor="let option of options" [value]="option[itemValue]">
        <!--        <ng-container [ngTemplateOutlet]="optionsTemplate" [ngTemplateOutletContext]="{$implicit: option}"></ng-container>-->
        <ng-container [ngTemplateOutlet]="optionsTemplate? optionsTemplate.template : defaultTemplate"
                      [ngTemplateOutletContext]="{$implicit: option}"></ng-container>
      </ng-jvx-option>

    </mat-selection-list>


  </mat-menu>

  <ng-content select="[options-template]"></ng-content>
</div>

<ng-template #defaultTemplate let-option>
  {{option.text}}
</ng-template>
